% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ternD.r
\name{ternD}
\alias{ternD}
\title{Generate descriptive summary table (optionally normality-aware)}
\usage{
ternD(
  data,
  vars = NULL,
  exclude_vars = NULL,
  force_ordinal = NULL,
  output_xlsx = NULL,
  output_docx = NULL,
  consider_normality = FALSE,
  print_normality = FALSE,
  round_intg = FALSE,
  smart_rename = FALSE,
  insert_subheads = TRUE,
  factor_order = "frequency"
)
}
\arguments{
\item{data}{Tibble with variables.}

\item{vars}{Character vector of variables to summarize. Defaults to all except \code{exclude_vars}.}

\item{exclude_vars}{Character vector to exclude from the summary.}

\item{force_ordinal}{Character vector of variables to treat as ordinal (i.e., use median [IQR]) 
regardless of the \code{consider_normality} setting. This parameter takes priority over 
normality testing when \code{consider_normality = TRUE}.}

\item{output_xlsx}{Optional Excel filename to export the table.}

\item{output_docx}{Optional Word filename to export the table.}

\item{consider_normality}{Logical; if \code{TRUE}, uses Shapiro-Wilk test to choose between 
mean ± SD (for normal data) vs median [IQR] (for non-normal data) for numeric variables. 
If \code{FALSE}, defaults to mean ± SD for all numeric variables unless specified in 
\code{force_ordinal}.}

\item{print_normality}{Logical; if \code{TRUE}, includes Shapiro-Wilk p-values as an 
additional column in the output.}

\item{round_intg}{Logical; if \code{TRUE}, rounds all means, medians, IQRs, and standard 
deviations to nearest integer (0.5 rounds up). Default is \code{FALSE}.}

\item{smart_rename}{Logical; if \code{TRUE}, automatically cleans variable names and 
subheadings for publication-ready output using hybrid AI+rules cleaning. Uses rule-based 
cleaning for known medical terms, falls back to AI for complex cases. Default is \code{FALSE}.}

\item{insert_subheads}{Logical; if \code{TRUE}, creates hierarchical structure with headers 
and indented sub-categories for multi-level categorical variables (except Y/N). If \code{FALSE}, 
uses simple flat format. Default is \code{TRUE}.}

\item{factor_order}{Character; controls the ordering of factor levels in the output. If 
\code{"frequency"} (default), orders levels by decreasing frequency (most common first). 
If \code{"levels"}, respects the original factor level ordering as defined in the data.}
}
\value{
A tibble with one row per variable (multi-row for factors), containing:
\describe{
  \item{Variable}{Variable names with appropriate indentation}
  \item{Summary}{Summary statistics (mean ± SD, median [IQR], or n (\%) as appropriate)}
  \item{SW_p}{Shapiro-Wilk p-values (only if \code{print_normality = TRUE})}
}
}
\description{
Creates a descriptive summary table with a single "Summary" column format.
For numeric variables, the default behavior is to show mean ± SD, but this
can be modified using the \code{consider_normality} and \code{force_ordinal} parameters.
}
\details{
The function always returns a tibble with a single "Summary" column format, regardless of the
\code{consider_normality} setting. The behavior for numeric variables follows this priority:
\enumerate{
  \item Variables in \code{force_ordinal}: Always use median [IQR]
  \item When \code{consider_normality = TRUE}: Use Shapiro-Wilk test to choose format
  \item When \code{consider_normality = FALSE}: Default to mean ± SD
}

For categorical variables, the function shows frequencies and percentages. When 
\code{insert_subheads = TRUE}, multi-level categorical variables are displayed with 
hierarchical formatting (main variable as header, levels as indented sub-rows), except 
for binary Y/N variables which use simple formatting.
}
\examples{
# Basic usage with default mean ± SD for numeric variables
ternD(mtcars)

# Use normality testing to choose summary format
ternD(mtcars, consider_normality = TRUE)

# Force specific variables to use median [IQR]
ternD(mtcars, force_ordinal = c("hp", "qsec"), consider_normality = TRUE)

# Export to Word document
ternD(mtcars, output_docx = "descriptive_table.docx", consider_normality = TRUE)

}
